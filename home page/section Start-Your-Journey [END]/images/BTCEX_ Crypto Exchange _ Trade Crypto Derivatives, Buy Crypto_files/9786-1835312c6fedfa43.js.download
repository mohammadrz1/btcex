"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9786],{77126:function(e,t,r){r.d(t,{s:function(){return c}});var n=r(85893),l=r(66330),i=r(87281),s=r(67294),o=r(26793),u=r(89736);function c(e){let{value:t,handle:r,...c}=e,{t:a}=(0,o.$)(),d=(0,s.useMemo)(()=>(0,i.ed)(t),[t]),f=(0,u.C)(()=>{null==r||r(d)});return(0,n.jsx)(l.z,{size:"medium",variant:"text",disabled:d.isZero(),onClick:f,...c,children:a("Public.Max")})}},99786:function(e,t,r){r.d(t,{l:function(){return L},X:function(){return N}});var n=r(85893),l=r(93284),i=r(3796),s=r(32562),o=r(89736),u=r(18440),c=r(49296),a={src:"/_next/static/media/success.da87dc9d.png",height:224,width:224,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAAV1BMVEVwm+hpk+KDpeVdhtuArPOQufk6ZMdMaXFqlOPK1Ohfid2Quvleid11n+lvmONxnOd/qO9lj+Cduu1+nt+3yempveSAqe+HsPNxmuZijN9tl+V2n+qCq/B/Bdz6AAAAGnRSTlP9o/scDowRAOP+k9f85vQk2tL+/f7+sOyu8PDEEcAAAAAJcEhZcwAAFiUAABYlAUlSJPAAAABCSURBVHicBcEHEsAgDAMwM8Omuz2H/7+zEsSHrRsn8HVRNTmE1QALg0ryyEx4233lUxMejmyhBbOT0D1C5jdSifIDczADW5Qn5doAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8},d=r(36078),f=r(30267),b=r(87357),x=r(51233),h=r(93946),m=r(67720),p=r(15861),v=r(41796),j=r(29950),g=r(54940),A=r(55010),C=r(33334),y=r(87281),w=r(10212),Z=r(67655),T=r(39860),E=r(63770),F=r(36339),P=r(18548),R=r(67294),I=r(73935),D=r(87536),S=r(26793),V=r(82649),U=r(26625),z=r(24635),k=r(42006),O=r(42965),B=r(53741),M=r(77126),W=r(47127),q=r(88017),Q=r(90936);let _={},H=new V.x;function X(e){let{preview:t,prev:r,next:l,accept:i,refresh:s,loading:o,confirm:u}=e,[c,a]=(0,R.useState)(10),{t:d}=(0,S.$)(),f=(0,R.useRef)(c);(0,R.useEffect)(()=>{if(t){a(10);let e=(0,U.H)(1e3,1e3).subscribe(()=>{a(e=>--e)});return()=>{e.unsubscribe()}}},[t]);let h=()=>{null==u||u(()=>{f.current>0&&(null==i||i())})};return f.current=c,(0,n.jsxs)(n.Fragment,{children:[t&&c<=0?(0,n.jsx)(b.Z,{mb:2.4,fontSize:12,color:"text.secondary",children:d("Convert.Index.ExpiredTip2")}):t&&(0,n.jsx)(b.Z,{mb:2.4,fontSize:12,color:"text.secondary",children:d("Convert.Index.ExpiredTip")}),(0,n.jsx)(x.Z,{direction:"row",spacing:1.6,children:t?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(A.zx,{size:40,fullWidth:!0,onClick:r,variant:"outlined",children:d("Convert.Index.Button.Back")}),c>0?(0,n.jsx)(A.zx,{size:40,fullWidth:!0,onClick:h,loading:o,children:d("Convert.Index.Button.Accept",{timeCount:c})}):(0,n.jsx)(A.zx,{loading:o,size:40,fullWidth:!0,onClick:()=>{a(10),null==s||s()},children:d("Convert.Index.Button.Refresh")})]}):(0,n.jsx)(A.zx,{size:40,fullWidth:!0,onClick:l,loading:o,children:d("Convert.Index.Button.Preview")})})]})}let L=e=>{let{success:t,to:r="USDT",...c}=e,{t:w}=(0,S.$)(),{isLogin:T}=(0,j.hn)(),{registerMui:E,...V}=(0,i.t)({defaultValues:{walletType:"",convertAmount:"",from:"",to:""}}),[,U]=(0,u.U)("$convertRecord"),[L,N]=(0,R.useState)(!1),[K,$]=(0,R.useState)([]),[Y,G]=(0,R.useState)([]),[J,ee]=(0,R.useState)();(0,R.useEffect)(()=>{let e;let t=V.watch((t,n)=>{let{name:l,type:i="reset"}=n;if("walletType"===l&&t[l]){let n=t[l];n&&!_[n]&&(_[n]=(0,z.D)(g.X.getWalletCoinList({walletType:n}))),null==e||e.unsubscribe(),e=_[n].subscribe(e=>{if(e.result){G(e.result);let t=c.from&&e.result.includes(c.from)?c.from:e.result[0];console.log(r,e.result,"to");let n=r&&e.result.includes(r)&&t!==r?r:e.result.find(e=>e!==t);V.resetField("from",{keepDirty:!0,defaultValue:t}),V.resetField("to",{keepDirty:!0,defaultValue:n})}e.error&&(0,Z.b)(e.error)})}});return()=>{null==e||e.unsubscribe(),t.unsubscribe()}},[V.watch,V.resetField,c.from,r]),(0,R.useEffect)(()=>{let e=(0,z.D)(g.X.getWalletList()).subscribe(e=>{e.result&&($(e.result),V.resetField("walletType",{keepDirty:!0,defaultValue:c.walletType&&e.result.includes(c.walletType)?c.walletType:e.result[0]})),e.error&&(0,Z.b)(e.error)});return()=>{e.unsubscribe()}},[V.resetField,c.walletType]);let et=(0,o.C)(e=>{let t=C.y.coinMapForFullName[e.toUpperCase()];return(0,n.jsxs)(x.Z,{direction:"row",spacing:.4,alignItems:"center",children:[(0,n.jsx)(b.Z,{component:"img",src:null==t?void 0:t.icon_svg,alt:"icon",width:"24px"}),(0,n.jsxs)(b.Z,{children:[null==t?void 0:t.coin_type,"(",null==t?void 0:t.full_name,")"]})]})}),[er,en,el,ei]=(0,D.qo)({control:V.control,name:["walletType","from","to","convertAmount"]}),[[es],eo,eu]=(0,s.K)([g.X.getWalletAvailableAmount,{walletType:er,fromCoinType:en}],{deps:[er,en],first:!1});(0,R.useEffect)(()=>{er&&en&&T&&eu()},[er,en,T,eu]);let ec=null==es?void 0:es.availableAmount,[[ea],,ed]=(0,s.K)([g.X.getUsedPersonalConvertQuota],{deps:[],first:!1});(0,R.useEffect)(()=>{T&&ed()},[T,ed]),(0,R.useEffect)(()=>{let e;let t=H.pipe((0,k.b)(()=>{N(!0)}),(0,O.b)(500),(0,B.x)((e,t)=>e.from===t.from&&e.to===t.to&&!t.refresh)).subscribe(t=>{let{from:r,to:n}=t;null==e||e.unsubscribe(),e=(0,z.D)(g.X.getConvertPrice({from:r,to:n})).subscribe({next:e=>{e.result&&(0,I.unstable_batchedUpdates)(()=>{ee(e.result)}),e.error&&(0,Z.b)(e.error)},error(){N(!1)},complete(){N(!1)}})});return()=>{null==e||e.unsubscribe(),t.unsubscribe()}},[]);let ef=(0,R.useCallback)((e,t)=>{g.X.getAssetsInfo({asset_type:["PERPETUAL"]}).then(l.R).then(r=>{var n;let l=null==r?void 0:null===(n=r.PERPETUAL)||void 0===n?void 0:n.bonus;if(!l||(0,y.ed)(l).lte(0)){e();return}(0,Q.f0)({title:w("Public.Confirm"),children:w("Wallet.Bonus.ConvertTips"),reject:{label:w("Public.Cancel"),action:async()=>(null==t||t(),!0)},resolve:{label:w("Public.Confirm"),action:async()=>(e(),!0)}})}).catch(Z.b)},[]),eb=Boolean(J),ex=eb||L||eo,eh=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(x.Z,{direction:"row",justifyContent:"space-between",mb:1.2,children:[(0,n.jsx)(b.Z,{color:"text.secondary",children:w("Convert.Index.24HQuota")}),(0,n.jsxs)(b.Z,{children:[ea?(0,y.ed)(ea.remainingPersonalConvertQuota).toFormat(2):"--"," /"," ",ea?(0,y.ed)(ea.allPersonalConvertQuota).toFormat(2):"--"," ","USDT"]})]}),(0,n.jsxs)(x.Z,{direction:"row",justifyContent:"space-between",mb:1.2,children:[(0,n.jsx)(b.Z,{color:"text.secondary",children:w("Convert.Index.Fee")}),(0,n.jsx)(b.Z,{color:"primary.main",children:"0%"})]})]});return(0,n.jsxs)(A.l0,{...V,children:[(0,n.jsx)(d.x,{label:w("Convert.Index.Wallet"),margin:"normal",disabled:ex,name:"walletType",children:(0,n.jsx)(D.Qr,{control:V.control,name:"walletType",render:e=>{let{field:{ref:t,...r}}=e;return(0,n.jsx)(f.Z,{size:"large",options:K,renderValue:e=>{var t;return(0,n.jsx)(n.Fragment,{children:w(null===(t=Reflect.get(W.xz,e.toLowerCase()))||void 0===t?void 0:t.label)})},getOptionValue:e=>e,...r,inputRef:t})}})}),(0,n.jsxs)(x.Z,{direction:"row",alignItems:"flex-end",spacing:.8,mb:1.6,children:[(0,n.jsx)(d.x,{label:w("Convert.Index.From"),margin:"none",disabled:ex||"USDT"===en,name:"from",children:(0,n.jsx)(D.Qr,{control:V.control,rules:{required:!0},name:"from",render:e=>{let{field:{ref:t,...r}}=e;return(0,n.jsx)(f.Z,{size:"large",options:Y,getOptionDisabled:e=>e===V.getValues("to"),getOptionValue:e=>e,...r,inputRef:t,renderValue:et})}})}),(0,n.jsx)(h.Z,{disabled:eb,onClick:()=>{let{from:e,to:t}=V.getValues();V.resetField("from",{keepDirty:!0,defaultValue:t}),V.resetField("to",{keepDirty:!0,defaultValue:e})},children:(0,n.jsx)(A.JO,{type:"icon-transfer"})}),(0,n.jsx)(d.x,{label:w("Convert.Index.To"),margin:"none",disabled:ex||"USDT"===el,name:"to",children:(0,n.jsx)(D.Qr,{rules:{required:!0},control:V.control,name:"to",render:e=>{let{field:{ref:t,...r}}=e;return(0,n.jsx)(f.Z,{getOptionDisabled:e=>e===V.getValues("from"),size:"large",options:Y,getOptionValue:e=>e,...r,inputRef:t,renderValue:et})}})})]}),(0,n.jsx)(q.b,{name:"convertAmount",label:w("Convert.Index.Amount"),margin:"normal",append:(0,n.jsxs)(b.Z,{children:[w("Public.Available")," :"," ",(0,F.F)({value:ec,acc:8,format:!0})," ",en]}),endAdornment:(0,n.jsx)(M.s,{value:null!=ec?ec:"0",handle:e=>{V.setValue("convertAmount",(0,y.ed)(e).toFixed(8))}}),rules:{required:!0,max:{value:null!=ec?ec:"0",message:w("CopyTrading.Trader.Available.Tip")},min:1e-8},inputHandle:(e,t)=>P.s.validFixed(8)(t)}),eb?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(x.Z,{direction:"row",justifyContent:"space-between",mb:1.2,children:[(0,n.jsx)(b.Z,{color:"text.secondary",children:w("Convert.Index.Price")}),(0,n.jsxs)(b.Z,{children:["1 ",en," = ",J?(0,y.ed)(J.price).toFormat(8):"--"," ",el]})]}),(0,n.jsxs)(x.Z,{direction:"row",justifyContent:"space-between",mb:1.2,children:[(0,n.jsx)(b.Z,{color:"text.secondary",children:w("Convert.Index.InversePrice")}),(0,n.jsxs)(b.Z,{children:["1 ",el," = ",J?(0,y.ed)(J.inversePrice).toFormat(8):"--"," ",en]})]}),eh,(0,n.jsxs)(x.Z,{direction:"row",justifyContent:"space-between",mb:2.4,children:[(0,n.jsx)(b.Z,{color:"text.secondary",children:w("Convert.Index.WillGet")}),(0,n.jsxs)(b.Z,{children:[J&&ei?(0,y.ed)(J.price).multipliedBy(ei).toFormat(8):"--"," ",el]})]}),(0,n.jsx)(m.Z,{sx:{mb:2.4}})]}):eh,(0,n.jsx)(X,{loading:L,preview:eb,next:V.handleSubmit(e=>{H.next({from:en,to:el,refresh:!0})}),prev:()=>{ee(void 0)},confirm:e=>{let t=V.getValues();(null==t?void 0:t.walletType)==="PERPETUAL"&&(null==t?void 0:t.from)==="USDT"?ef(e):e()},refresh:()=>{ee(void 0),H.next({from:en,to:el,refresh:!0})},accept:V.handleSubmit(e=>{N(!0),g.X.initiateConvert(e).subscribe({next(e){e.result?((0,I.unstable_batchedUpdates)(()=>{ee(void 0),N(!1),V.resetField("convertAmount")}),eu(),ed(),U.current(),(0,Q.f0)({children:(0,n.jsxs)(b.Z,{textAlign:"center",children:[(0,n.jsx)(b.Z,{component:"img",src:a.src,alt:"success",width:"112px",mb:2.2}),(0,n.jsx)(p.Z,{variant:"h4",fontSize:20,mb:2.4,children:w("Convert.Index.Modal.Successful")}),(0,n.jsx)(b.Z,{fontSize:16,mb:2.4,color:"text.secondary",children:w("Convert.Index.Modal.SubTitle")}),(0,n.jsxs)(p.Z,{variant:"h3",mb:2.4,children:[(0,y.ed)(e.result.toAmount).toFormat(8)," ",el]}),(0,n.jsxs)(b.Z,{bgcolor:e=>{let{palette:t}=e;return(0,v.Fq)(t.secondary.main,.05)},sx:{borderRadius:4},p:1.6,children:[(0,n.jsxs)(x.Z,{direction:"row",justifyContent:"space-between",mb:1.2,children:[(0,n.jsx)(b.Z,{color:"text.secondary",children:w("Convert.Index.Modal.Price")}),(0,n.jsxs)(b.Z,{children:["1 ",en," = ",(0,y.ed)(e.result.price).toFormat(8)," ",el]})]}),(0,n.jsxs)(x.Z,{direction:"row",justifyContent:"space-between",children:[(0,n.jsx)(b.Z,{color:"text.secondary",children:w("Convert.Index.Modal.InversePrice")}),(0,n.jsxs)(b.Z,{children:["1 ",el," ="," ",(0,y.ed)(e.result.inversePrice).toFormat(8)," ",en]})]})]})]}),hideCancel:!0,resolve:{fullWidth:!0,action:t}})):(e.error&&(0,Z.b)(e.error),N(!1))}})})})]})};function N(e){let{isIPhone:t,isAndroid:r}=(0,w.l7)();if(t||r){T.m.replace((0,E.DW)("Download"));return}let l=(0,Q.f0)({title:(0,c.vA)("Convert.Index.Modal.Title"),children:(0,n.jsx)(L,{...e,success:()=>{l.destroy()}}),footer:null});return l}},88017:function(e,t,r){r.d(t,{b:function(){return c}});var n=r(85893),l=r(36078),i=r(8314),s=r(67294),o=r(87536);let u=()=>!0;function c(e){let{append:t,name:r,label:c,margin:a,rules:d,control:f,disabled:b,defaultValue:x,inputHandle:h=u,shouldUnregister:m=!0,errorTooltip:p,size:v,formItemProps:j,...g}=e,A=(0,s.useRef)(null!=d?d:{});return(0,s.useMemo)(()=>{if(d){for(let e of Object.keys(A.current))Reflect.has(d,e)||Reflect.deleteProperty(A.current,e);Object.assign(A.current,d)}},[d]),(0,n.jsx)(o.Qr,{shouldUnregister:m,defaultValue:x,control:f,name:r,rules:A.current,render:e=>{let{field:{ref:r,value:s,onChange:o,onBlur:u,name:d}}=e;return(0,n.jsx)(l.x,{size:v,label:c,name:d,append:t,disabled:b,margin:a,errorTooltip:p,...j,children:(0,n.jsx)(i.I,{inputRef:r,value:s,name:d,onChange:e=>{let{value:t}=e.target,r=h(e,t);(""===t||r)&&("string"==typeof r?o(r):o(e))},onBlur:u,...g})})}})}},32562:function(e,t,r){r.d(t,{K:function(){return x}});var n=r(93284),l=r(29950),i=r(10212),s=r(67655),o=r(67294),u=r(73935),c=r(40317),a=r(24635),d=r(74727),f=r(91400),b=r(18440);let x=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];let{isLogin:x}=(0,l.hn)(),[h,m]=(0,o.useState)([]),p=(0,o.useRef)({id:(0,i.N_)(5)}),[v,j]=(0,o.useState)(!1),g=(0,o.useRef)(!1),A=(0,o.useRef)(t);A.current=t;let C=A.current.length,y=A.current[C-1],{key:w,deps:Z=[],first:T=!0,auth:E=!1}=y,[,F]=(0,b.U)(null!=w?w:p.current.id),P=(0,o.useCallback)(()=>g.current,[]);return(0,o.useEffect)(()=>F.current.subscribe(()=>{let e=A.current.length,t=A.current.slice(0,e-1);t.length&&(j(!0),p.current.sub=(0,c.a)(t.map(e=>{let[t,r]=e;return(0,a.D)(t(r).then(n.R))})).pipe((0,d.q)(e)).subscribe({next(e){(0,u.unstable_batchedUpdates)(()=>{m(e.map(e=>e)),j(!1),g.current=!0})},error(e){(0,s.b)(e),j(!1)}}))}),[F,E,x]),(0,f.Yu)([()=>{if(T&&(!E||x)){let e=F.current();return()=>{var t;e(),null===(t=p.current.sub)||void 0===t||t.unsubscribe()}}return()=>{var e;null===(e=p.current.sub)||void 0===e||e.unsubscribe()}}],[F,T,E,x,...Z]),[h,v,F.current,P]}},91400:function(e,t,r){r.d(t,{VX:function(){return c},Yu:function(){return a},q$:function(){return d}});var n=r(93284),l=r(67294),i=r(26625),s=r(19293),o=r(4222),u=r(34978);let c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e3,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return(0,i.H)(r,t).pipe((0,u.w)(()=>e instanceof s.y?e:e().then(n.R)))};function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];(0,l.useEffect)(()=>{let t=new o.w0;return e.forEach(e=>{t.add(e())}),()=>{t.unsubscribe()}},[...t])}function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];(0,l.useEffect)(()=>{let t=new o.w0;return e.forEach(e=>{t.add(e())}),()=>{t.unsubscribe()}},[...t])}},18440:function(e,t,r){r.d(t,{U:function(){return o},q:function(){return s}});var n=r(67294);let l={},i=()=>{};function s(e,t){if(l[e])return l[e].trigger;let r=()=>{l[e]&&!l[e].subscriber.length&&(l[e].trigger=void 0,Reflect.deleteProperty(l,e))};function n(){if(l[e]){let{subscriber:t=[]}=l[e];t.forEach(e=>{e()})}return r}return n.update=null!=t?t:i,n.dispose=r,n.subscribe=function(t){return l[e]?l[e].subscriber.push(t):l[e]={subscriber:[t],trigger:this},()=>{if(l[e]){let r=l[e].subscriber.indexOf(t);r>-1&&l[e].subscriber.splice(r,1)}}},n}function o(e){let[t,r]=(0,n.useState)(()=>new Date),l=(0,n.useRef)();return l.current||(l.current=s(e,()=>{r(new Date)})),[t,l]}}}]);